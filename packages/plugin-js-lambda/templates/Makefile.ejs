<% if (('undefined' !== typeof generateEnvLocal) && (true === generateEnvLocal)) { -%>
env ?= dev

<% } -%>
all: install

pre-install:
	@true

install:
	@yarn --silent install

clean:
	@rm -rf node_modules && rm -rf coverage

test:
	@yarn --silent test --color

test-cov:
	@yarn test --coverage --color

test-ci:
	@CI=true yarn test --all --coverage --color --detectOpenHandles

build:
	@yarn --silent build
<% if (true === deployable) { %>
deploy:
	@yarn --silent deploy
<% } %>
<% if (('undefined' !== typeof generateEnvLocal) && (true === generateEnvLocal)) { %>
generate-env-local:
	@../node_modules/.bin/generate-vars-from-terraform-outputs $(env) ./terraform-to-vars.json > ./.env.local
<% } %>
.PHONY: all pre-install install test build clean<%- true === deployable ? ' deploy' : '' -%><% if (('undefined' !== typeof generateEnvLocal) && (true === generateEnvLocal)) { %> generate-env-local<% } %>